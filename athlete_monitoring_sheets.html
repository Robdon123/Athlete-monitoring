<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Athlete Monitoring System - Google Sheets Template</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px 15px 0 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tab:last-child {
            border-right: none;
        }

        .tab:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .tab.active {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
        }

        .tab-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 0 0 15px 15px;
            padding: 25px;
            min-height: 600px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-top: none;
        }

        .sheet-section {
            display: none;
        }

        .sheet-section.active {
            display: block;
        }

        .sheet-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .sheet-table th {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 15px 10px;
            text-align: center;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .sheet-table td {
            padding: 12px 10px;
            text-align: center;
            border-bottom: 1px solid #f0f0f0;
        }

        .sheet-table tr:hover {
            background: #f8f9ff;
        }

        .readiness-high { background: #d4edda; color: #155724; }
        .readiness-medium { background: #fff3cd; color: #856404; }
        .readiness-low { background: #f8d7da; color: #721c24; }

        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .chart {
            width: 100%;
            height: 300px;
            background: linear-gradient(45deg, #f8f9fa, #e9ecef);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 1.1rem;
            margin: 15px 0;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .dashboard-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .dashboard-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .dashboard-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .value-high { color: #28a745; }
        .value-medium { color: #ffc107; }
        .value-low { color: #dc3545; }

        .formula-box {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }

        .formula-title {
            font-weight: bold;
            color: #495057;
            margin-bottom: 10px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .input-form {
            background: #f8f9ff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #495057;
        }

        .form-group input, .form-group select {
            padding: 10px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 1rem;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .export-section {
            background: #e8f5e8;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .weight-delta-positive { color: #dc3545; font-weight: bold; }
        .weight-delta-negative { color: #28a745; font-weight: bold; }

        .download-info {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÉ‚Äç‚ôÇÔ∏è Athlete Monitoring System</h1>
            <p>Complete Google Sheets Template for Performance Tracking</p>
        </div>

        <div class="download-info">
            <h3>üì• How to Download This Template</h3>
            <p><strong>Right-click anywhere on this page ‚Üí "Save Page As" ‚Üí Save as "athlete-monitoring.html"</strong></p>
            <p>Then open the saved file in your browser for full functionality!</p>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="daily-log">Daily Log</button>
            <button class="tab" data-tab="readiness">Readiness Tracking</button>
            <button class="tab" data-tab="weight-cut">Weight Cut</button>
            <button class="tab" data-tab="dashboard">Dashboard</button>
            <button class="tab" data-tab="export">Export CSV</button>
        </div>

        <div class="tab-content">
            <!-- Daily Log Tab -->
            <div id="daily-log" class="sheet-section active">
                <h2>üìù Daily Log - Athlete Input Sheet</h2>
                <p>Athletes enter their daily metrics here. Simple and quick to complete.</p>

                <div class="input-form">
                    <h3>Add Today's Entry</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Date</label>
                            <input type="date" id="entry-date">
                        </div>
                        <div class="form-group">
                            <label>HRV (ms)</label>
                            <input type="number" id="hrv" placeholder="45" min="20" max="100">
                        </div>
                        <div class="form-group">
                            <label>Resting HR (bpm)</label>
                            <input type="number" id="rhr" placeholder="60" min="40" max="100">
                        </div>
                        <div class="form-group">
                            <label>Sleep (hours)</label>
                            <input type="number" id="sleep" placeholder="7.5" min="3" max="12" step="0.5">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Soreness (1-10)</label>
                            <select id="soreness">
                                <option value="">Select...</option>
                                <option value="1">1 - No soreness</option>
                                <option value="2">2 - Very light</option>
                                <option value="3">3 - Light</option>
                                <option value="4">4 - Mild</option>
                                <option value="5">5 - Moderate</option>
                                <option value="6">6 - Somewhat hard</option>
                                <option value="7">7 - Hard</option>
                                <option value="8">8 - Very hard</option>
                                <option value="9">9 - Extremely hard</option>
                                <option value="10">10 - Maximum</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Mood (1-5)</label>
                            <select id="mood">
                                <option value="">Select...</option>
                                <option value="1">1 - Very poor</option>
                                <option value="2">2 - Poor</option>
                                <option value="3">3 - Average</option>
                                <option value="4">4 - Good</option>
                                <option value="5">5 - Excellent</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Notes</label>
                            <input type="text" id="notes" placeholder="Optional notes...">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button class="btn" id="add-entry-btn">Add Entry</button>
                        </div>
                    </div>
                </div>

                <table class="sheet-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>HRV (ms)</th>
                            <th>Resting HR</th>
                            <th>Sleep (hrs)</th>
                            <th>Soreness</th>
                            <th>Mood</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody id="daily-log-data">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>

                <div class="formula-box">
                    <div class="formula-title">Google Sheets Setup Instructions:</div>
                    1. Create columns A-G with headers: Date, HRV, Resting HR, Sleep, Soreness, Mood, Notes<br>
                    2. Format Date column as Date format<br>
                    3. Add Data Validation: Soreness (1-10), Mood (1-5)<br>
                    4. Use conditional formatting for extreme values (HRV <40, Soreness >7)
                </div>
            </div>

            <!-- Readiness Tracking Tab -->
            <div id="readiness" class="sheet-section">
                <h2>‚ö° Readiness Tracking - Automated Calculations</h2>
                <p>Automatically calculates readiness scores with traffic-light conditional formatting.</p>

                <div class="formula-box">
                    <div class="formula-title">Readiness Score Formula (Column H):</div>
                    =ROUND((((B2-40)/20)*0.4 + (C2/10)*0.3 + ((11-E2)/10)*0.2 + (F2/5)*0.1)*100, 0)<br><br>
                    <strong>Breakdown:</strong><br>
                    ‚Ä¢ HRV normalized (40-60ms range) √ó 40% weight<br>
                    ‚Ä¢ Sleep normalized (0-10hrs) √ó 30% weight<br>
                    ‚Ä¢ Soreness inverted (lower = better) √ó 20% weight<br>
                    ‚Ä¢ Mood normalized (1-5 scale) √ó 10% weight
                </div>

                <table class="sheet-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>HRV</th>
                            <th>Sleep</th>
                            <th>Soreness</th>
                            <th>Mood</th>
                            <th>Readiness Score</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="readiness-data">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>

                <div class="chart-container">
                    <h3>Readiness Trend Chart</h3>
                    <div class="chart">
                        üìà Line Chart: Readiness Score Over Time<br>
                        (Use Google Sheets Chart function with Readiness Score column)
                    </div>
                </div>
            </div>

            <!-- Weight Cut Tab -->
            <div id="weight-cut" class="sheet-section">
                <h2>‚öñÔ∏è Weight Cut Management</h2>
                <p>Track actual weight vs target weight with deviation alerts.</p>

                <table class="sheet-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Actual Weight (lbs)</th>
                            <th>Target Weight (lbs)</th>
                            <th>Delta (lbs)</th>
                            <th>Status</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2024-08-19</td>
                            <td>157.2</td>
                            <td>155.0</td>
                            <td class="weight-delta-positive">+2.2</td>
                            <td>‚ö†Ô∏è Above Target</td>
                            <td>Need to increase cut pace</td>
                        </tr>
                        <tr>
                            <td>2024-08-18</td>
                            <td>158.1</td>
                            <td>155.5</td>
                            <td class="weight-delta-positive">+2.6</td>
                            <td>‚ö†Ô∏è Above Target</td>
                            <td>Water loading phase</td>
                        </tr>
                        <tr>
                            <td>2024-08-17</td>
                            <td>159.3</td>
                            <td>156.0</td>
                            <td class="weight-delta-positive">+3.3</td>
                            <td>üö® High Deviation</td>
                            <td>Starting cut protocol</td>
                        </tr>
                    </tbody>
                </table>

                <div class="chart-container">
                    <h3>Weight Cut Progress Chart</h3>
                    <div class="chart">
                        üìâ Dual Line Chart: Actual Weight vs Target Weight<br>
                        Shows cut trajectory and compliance
                    </div>
                </div>
            </div>

            <!-- Dashboard Tab -->
            <div id="dashboard" class="sheet-section">
                <h2>üìä Coach Dashboard - Overview & Analytics</h2>
                <p>Comprehensive view of athlete status with key metrics and trends.</p>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>Current Readiness</h3>
                        <div class="dashboard-value value-high" id="current-readiness">87</div>
                        <p>üü¢ Ready to Train</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>7-Day Average</h3>
                        <div class="dashboard-value value-medium" id="avg-readiness">76</div>
                        <p>Moderate Range</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>Weight Status</h3>
                        <div class="dashboard-value value-low">+2.2</div>
                        <p>lbs above target</p>
                    </div>
                    <div class="dashboard-card">
                        <h3>Days This Week</h3>
                        <div class="dashboard-value">
                            <span class="value-high" id="green-days">3</span>
                            <span class="value-medium" id="yellow-days">2</span>
                            <span class="value-low" id="red-days">2</span>
                        </div>
                        <p>üü¢ üü° üî¥ Distribution</p>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>Weekly Readiness Heatmap</h3>
                    <div class="chart">
                        üóìÔ∏è Calendar Heatmap: Daily Readiness Scores<br>
                        Color-coded by readiness level (Green/Yellow/Red)
                    </div>
                </div>
            </div>

            <!-- Export CSV Tab -->
            <div id="export" class="sheet-section">
                <h2>üì§ Export CSV - Weekly Reports</h2>
                <p>Generate weekly CSV exports for external analysis or Excel import.</p>

                <div class="export-section">
                    <h3>üîÑ Automated Weekly Export</h3>
                    <p>This sheet automatically pulls the last 7 days of data for easy export.</p>

                    <div class="formula-box">
                        <div class="formula-title">Export Filter Formula (Auto-updates):</div>
                        =FILTER(Daily_Log!A2:G, Daily_Log!A2:A>=TODAY()-7)<br><br>
                        This formula automatically includes only the last 7 days of data.
                        To export: File ‚Üí Download ‚Üí CSV
                    </div>
                </div>

                <table class="sheet-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>HRV</th>
                            <th>Sleep</th>
                            <th>Soreness</th>
                            <th>Mood</th>
                            <th>Readiness</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody id="export-data">
                        <!-- Export preview data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Initialize data
        let dailyLogData = [
            {date: '2024-08-19', hrv: 52, rhr: 58, sleep: 8.0, soreness: 3, mood: 4, notes: 'Feeling good, light training'},
            {date: '2024-08-18', hrv: 48, rhr: 62, sleep: 7.5, soreness: 5, mood: 3, notes: 'Hard session yesterday'},
            {date: '2024-08-17', hrv: 45, rhr: 65, sleep: 6.5, soreness: 7, mood: 2, notes: 'Legs very sore, poor sleep'},
            {date: '2024-08-16', hrv: 55, rhr: 56, sleep: 8.5, soreness: 2, mood: 5, notes: 'Rest day, feeling great'},
            {date: '2024-08-15', hrv: 50, rhr: 60, sleep: 7.0, soreness: 4, mood: 4, notes: 'Normal training day'}
        ];

        // Helper functions
        function calculateReadiness(hrv, sleep, soreness, mood) {
            const hrvNorm = Math.max(0, Math.min(1, (hrv - 40) / 20));
            const sleepNorm = Math.max(0, Math.min(1, sleep / 10));
            const sorenessNorm = Math.max(0, Math.min(1, (11 - soreness) / 10));
            const moodNorm = Math.max(0, Math.min(1, mood / 5));
            
            const readiness = (hrvNorm * 0.4 + sleepNorm * 0.3 + sorenessNorm * 0.2 + moodNorm * 0.1) * 100;
            return Math.round(readiness);
        }

        function getReadinessClass(score) {
            if (score >= 80) return 'readiness-high';
            if (score >= 60) return 'readiness-medium';
            return 'readiness-low';
        }

        function getReadinessStatus(score) {
            if (score >= 80) return 'üü¢ Ready';
            if (score >= 60) return 'üü° Moderate';
            return 'üî¥ Caution';
        }

        // Update tables
        function updateDailyLogTable() {
            const tbody = document.getElementById('daily-log-data');
            tbody.innerHTML = '';

            dailyLogData.forEach(entry => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${entry.date}</td>
                    <td>${entry.hrv}</td>
                    <td>${entry.rhr}</td>
                    <td>${entry.sleep}</td>
                    <td>${entry.soreness}</td>
                    <td>${entry.mood}</td>
                    <td>${entry.notes}</td>
                `;
            });
        }

        function updateReadinessTable() {
            const tbody = document.getElementById('readiness-data');
            tbody.innerHTML = '';

            dailyLogData.forEach(entry => {
                const readinessScore = calculateReadiness(entry.hrv, entry.sleep, entry.soreness, entry.mood);
                const readinessClass = getReadinessClass(readinessScore);
                const status = getReadinessStatus(readinessScore);

                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${entry.date}</td>
                    <td>${entry.hrv}</td>
                    <td>${entry.sleep}</td>
                    <td>${entry.soreness}</td>
                    <td>${entry.mood}</td>
                    <td class="${readinessClass}">${readinessScore}</td>
                    <td class="${readinessClass}">${status}</td>
                `;
            });
        }

        function updateExportTable() {
            const tbody = document.getElementById('export-data');
            tbody.innerHTML = '';

            // Show last 7 days (or all if less than 7)
            const exportData = dailyLogData.slice(0, Math.min(7, dailyLogData.length));
            
            exportData.forEach(entry => {
                const readinessScore = calculateReadiness(entry.hrv, entry.sleep, entry.soreness, entry.mood);
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${entry.date}</td>
                    <td>${entry.hrv}</td>
                    <td>${entry.sleep}</td>
                    <td>${entry.soreness}</td>
                    <td>${entry.mood}</td>
                    <td>${readinessScore}</td>
                    <td>${entry.notes}</td>
                `;
            });
        }

        function updateDashboard() {
            if (dailyLogData.length === 0) return;

            // Current readiness
            const currentEntry = dailyLogData[0];
            const currentReadiness = calculateReadiness(currentEntry.hrv, currentEntry.sleep, currentEntry.soreness, currentEntry.mood);
            document.getElementById('current-readiness').textContent = currentReadiness;

            // 7-day average
            const last7Days = dailyLogData.slice(0, Math.min(7, dailyLogData.length));
            const avgReadiness = Math.round(last7Days.reduce((sum, entry) => {
                return sum + calculateReadiness(entry.hrv, entry.sleep, entry.soreness, entry.mood);
            }, 0) / last7Days.length);
            document.getElementById('avg-readiness').textContent = avgReadiness;

            // Count distribution
            let greenDays = 0, yellowDays = 0, redDays = 0;
            last7Days.forEach(entry => {
                const score = calculateReadiness(entry.hrv, entry.sleep, entry.soreness, entry.mood);
                if (score >= 80) greenDays++;
                else if (score >= 60) yellowDays++;
                else redDays++;
            });

            document.getElementById('green-days').textContent = greenDays;
            document.getElementById('yellow-days').textContent = yellowDays;
            document.getElementById('red-days').textContent = redDays;
        }

        // Tab switching
        function showTab(tabName) {
            // Hide all sections
            document.querySelectorAll('.sheet-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(tabName).classList.add('active');
            
            // Add active to clicked tab
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        }

        // Add entry function
        function addDailyEntry() {
            const date = document.getElementById('entry-date').value;
            const hrv = parseFloat(document.getElementById('hrv').value);
            const rhr = parseFloat(document.getElementById('rhr').value);
            const sleep = parseFloat(document.getElementById('sleep').value);
            const soreness = parseInt(document.getElementById('soreness').value);
            const mood = parseInt(document.getElementById('mood').value);
            const notes = document.getElementById('notes').value || '';

            if (!date || !hrv || !rhr || !sleep || !soreness || !mood) {
                alert('Please fill in all required fields');
                return;
            }

            const newEntry = { date, hrv, rhr, sleep, soreness, mood, notes };
            dailyLogData.unshift(newEntry);

            updateAllTables();

            // Clear form
            ['entry-date', 'hrv', 'rhr', 'sleep', 'soreness', 'mood', 'notes'].forEach(id => {
                document.getElementById(id).value = '';
            });

            alert('Entry added successfully!');
        }

        function updateAllTables() {
            updateDailyLogTable();
            updateReadinessTable();
            updateExportTable();
            updateDashboard();
        }

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Set today's date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('entry-date').value = today;

            // Set up tab listeners
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    showTab(tabName);
                });
            });

            // Set up add entry button
            document.getElementById('add-entry-btn').addEventListener('click', addDailyEntry);

            // Initialize all tables
            updateAllTables();
        });
    </script>
</body>
</html>